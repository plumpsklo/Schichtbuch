{% load static %}
<!doctype html>
<html lang="de" data-theme="light">
<head>
    <meta charset="utf-8">
    <title>Schichtbuch â€“ {% block title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        /* ----------------------------------------------------
           Farbvariablen (Hell/Dunkel)
        ---------------------------------------------------- */
        :root {
            --bg-color: #f5f5f5;
            --bg-alt: #ffffff;
            --text: #111;
            --text-muted: #666;
            --border: #ccc;
            --header-bg: #eee;
            --card-bg: #fafafa;

            --primary: #0078ff;
            --primary-text: #fff;

            --danger: #d62828;
            --danger-text: #fff;

            --input-height: 38px;
            --input-font: 15px;
            --input-pad: 6px 8px;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --bg-alt: #181818;
            --text: #eaeaea;
            --text-muted: #9b9b9b;
            --border: #333;
            --header-bg: #1e1e1e;
            --card-bg: #1c1c1c;

            --primary: #3e8bff;
            --danger: #ff4d4d;
        }

        /* ----------------------------------------------------
           Basic Layout
        ---------------------------------------------------- */
        body {
            margin: 14px;
            font-family: system-ui, -apple-system, sans-serif;
            color: var(--text);
            background: var(--bg-color);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: var(--bg-alt);
            padding: 16px 18px 40px 18px;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        header h1 {
            margin-bottom: 10px;
            font-size: 26px;
        }

        nav {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            margin-bottom: 18px;
        }

        .nav-spacer { flex: 1 1 auto; }

        /* ----------------------------------------------------
           Tabellen
        ---------------------------------------------------- */
        .table-wrapper { overflow-x: auto; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid var(--border);
            padding: 6px 8px;
            font-size: 14px;
        }

        th { background: var(--header-bg); }

        /* ----------------------------------------------------
           Statistik-Kacheln
        ---------------------------------------------------- */
        .stats {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .stat-box {
            padding: 10px;
            flex: 1 1 140px;
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 5px;
        }

        .stat-label { font-size: 12px; color: var(--text-muted); }
        .stat-value { font-size: 20px; font-weight: bold; }

        /* ----------------------------------------------------
           Buttons
        ---------------------------------------------------- */
        .btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: 1px solid var(--primary);
            background: var(--bg-alt);
            color: var(--primary);
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            transition: 0.2s;
        }

        .btn:hover {
            background: var(--primary);
            color: var(--primary-text);
        }

        .btn-primary {
            background: var(--primary);
            color: var(--primary-text);
            border-color: var(--primary);
        }

        .btn-danger {
            border-color: var(--danger);
            color: var(--danger);
            background: transparent;
        }

        .btn-danger:hover {
            background: var(--danger);
            color: var(--danger-text);
        }

        /* ----------------------------------------------------
           Formulare / Inputs
        ---------------------------------------------------- */
        label {
            display: block;
            margin-bottom: 2px;
            font-size: 14px;
            font-weight: 600;
        }

        input,
        select,
        textarea {
            width: 100%;
            height: var(--input-height);
            padding: var(--input-pad);
            font-size: var(--input-font);
            border: 1px solid var(--border);
            background: var(--bg-alt);
            color: var(--text);
            border-radius: 4px;
            box-sizing: border-box;
        }

        textarea { height: auto; min-height: 90px; }

        /* ðŸ”¥ Fix fÃ¼r iPhone & Android: Datum/Uhrzeit zu groÃŸ */
        input[type="date"],
        input[type="time"] {
            appearance: none;
            -webkit-appearance: none;
            height: var(--input-height) !important;
            padding: var(--input-pad) !important;
            font-size: var(--input-font) !important;
        }

        .field { margin-bottom: 10px; }

        .errors { color: #d00; margin-bottom: 6px; }

        /* ----------------------------------------------------
           Status-Farben
        ---------------------------------------------------- */
        .status-OFFEN { background: #fff3cd; color: #775900; font-weight: 600; }
        .status-IN_ARB { background: #cfe2ff; color: #003a75; font-weight: 600; }
        .status-ERLED { background: #d4edda; color: #155724; font-weight: 600; }

        /* ----------------------------------------------------
           Mobil Anpassungen
        ---------------------------------------------------- */
        @media (max-width: 600px) {
            body { margin: 8px; }
            header h1 { font-size: 22px; }
            .btn { padding: 6px 10px; font-size: 14px; }

            th, td { white-space: nowrap; }
        }
    </style>
</head>

<body>
<div class="container">
    <header>
        <h1>Schichtbuch</h1>

        <nav>
            {% if user.is_authenticated %}
                <a href="{% url 'home' %}" class="btn">Ãœbersicht</a>
                <a href="{% url 'new_entry' %}" class="btn btn-primary">Neuer Eintrag</a>

                <span>Angemeldet als: {{ user.username }}</span>
                <a href="{% url 'password_change' %}" class="btn">Passwort Ã¤ndern</a>
                <a href="{% url 'logout' %}" class="btn btn-danger">Logout</a>
            {% else %}
                <a href="{% url 'login' %}" class="btn">Login</a>
            {% endif %}

            <a href="/admin/" class="btn">Admin</a>
            <span class="nav-spacer"></span>

            <button type="button" id="themeToggle" class="btn">ðŸŒ™ Dunkel</button>
        </nav>
    </header>

    {% block content %}{% endblock %}
</div>

<!-- App Version -->
<div style="position: fixed; bottom: 5px; right: 10px; font-size: 11px; color: #aaa;">
    Version {{ APP_VERSION }} â€“ {{ APP_STAGE|capfirst }}
</div>

<!-- Theme Script -->
<script>
    (function(){
        const KEY = "schichtbuch-theme";
        const root = document.documentElement;
        const btn = document.getElementById("themeToggle");

        function apply(theme){
            root.setAttribute("data-theme", theme);
            btn.textContent = theme === "dark" ? "â˜€ï¸ Hell" : "ðŸŒ™ Dunkel";
        }

        const saved = localStorage.getItem(KEY);
        apply(saved || "light");

        btn.addEventListener("click", () => {
            const next = (root.getAttribute("data-theme") === "light") ? "dark" : "light";
            localStorage.setItem(KEY, next);
            apply(next);
        });
    })();
</script>
</body>
</html>